<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>Calculator</title>
        <link rel="stylesheet" href="styles.css"/>
    </head>
    <body>
            <div id="calculator-container">
                <!-- div to remove line between elements-->
                <div class="screenbg">
                <input type="string" id="secondary-screen" readonly>

                </input>
                <input type="string" id="operator-display" readonly>

                </input>
                <input type="string" id="main-screen" readonly>

                </input>
                </div>
                <div class="row" id="row1">
                    <button id="clear"  data-value="cls" data-type="operator">
                        C
                    </button>
                    <button  data-value="del" data-type="operator">
                        DEL
                    </button>
                    <button data-value="/" data-type="operator">
                        &#247;
                    </button>
                </div>
                <div class="row" id="row2">
                    <button  data-value ="1" data-type="number">
                        1
                    </button>
                    <button  data-value ="2" data-type="number">
                        2
                    </button>
                    <button  data-value ="3" data-type="number">
                        3
                    </button>
                    <button  data-value ="*"  data-type="operator" >
                        x
                    </button>
                </div>
                <div class="row" id="row3">
                    <button  data-value="4" data-type="number" >
                        4
                    </button>
                    <button  data-value="5" data-type="number" >
                        5
                    </button>
                    <button  data-value="6" data-type="number" >
                        6
                    </button>
                    <button  data-value="-" data-type="operator"  >
                        -
                    </button>
                </div>
                <div class="row" id="row4">
                    <button  data-value="7" data-type="number" >
                        7
                    </button>
                    <button  data-value="8" data-type="number" >
                        8
                    </button>
                    <button  data-value="9" data-type="number">
                        9
                    </button>
                    <button  data-value="+"  data-type="operator" >
                        +
                    </button>
                </div>
                <div class="row" id="row5">
                    <button  data-value="." data-type="number">
                        .
                    </button>
                    <button  data-value="0" data-type="number" >
                        0
                    </button>
                    <button id="equal" data-value="=" data-type="operator">
                        =
                    </button>
                </div>
            </div>
        <script>
         
           const buttons = document.querySelectorAll("button");
           const mainScreen = document.getElementById("main-screen");
           const secondaryScreen = document.getElementById("secondary-screen");
           const operatorDisplay = document.getElementById("operator-display");

           let currOperator;


           buttons.forEach((button) => {
            button.addEventListener("click", (e) => {
               if(button.dataset.type === "number"){
                  handleNumber(button.dataset.value)
               } else {
                handleOperator(button.dataset.value)
               }  
            })
           })


           function handleNumber(num) {
             mainScreen.value += num;
           }

           function handleOperator(operator) {
             switch (operator) {

                case "cls":
                  mainScreen.value = "0";
                  secondaryScreen.value = "";
                  currOperator = undefined;
                  operatorDisplay.value = "";
                  break;

                case "del":
                  const newValue = mainScreen.value.slice(0, -1); //Look up the slice method, a string is an array of characters so I am using an 
                                                                  //array method to "slice" the string but leave out the last character
                  mainScreen.value = newValue;
                  break;

                case "/":
                    setOperator("/")
                    break;

                case "*":
                    setOperator("*")
                    break;
                
                case "-":
                    setOperator("-")
                    break;
                
                case "+":
                    setOperator("+")
                    break;   
                    
                case "=":
                    calculateAnswer()
                    break;    

                
                default:
                    break;

             }
           }

           function setOperator(operator) {
                console.log(operator)
                 
                if(!currOperator) {//This means if currOperator is undefined. Look up implicit type coercion                     
                    secondaryScreen.value = mainScreen.value;
                    currOperator = operator;
                    operatorDisplay.value = operator;
                    mainScreen.value = "";
                } else {
                    currOperator = operator;
                    operatorDisplay.value = operator;
                }
                
           }

           function calculateAnswer() {
              const num1 =  Number.parseFloat(secondaryScreen.value);
              const num2 = Number.parseFloat(mainScreen.value);
              let answer;
              
              switch (currOperator) {
                case "/":
                    answer = num1 / num2;
                    break;

                case "*":
                    answer = num1 * num2;
                    break;
                
                case "-":
                    answer = num1 - num2;
                    break;
                
                case "+":
                    answer = num1 + num2;
                    break;

                default:
                    answer = NaN
                    break;    
              }
              
              secondaryScreen.value = "";
              operatorDisplay.value = "";
              mainScreen.value = answer;

           }

            document.addEventListener("DOMContentLoaded", () => {
                onClear();
            }); 
            
            let valScreen2;
            let calcAns;
            let screenOutput;
            let valSc2StoreAfter1stEqual;
            let operatortype;
            let operatortype2;
            let result;
            let isEqualClicked;
            let isOperatorClicked;
            let isOperatorClickedThisEqual;
            let isDecimalClicked;
            let sinceDecimalClicked;
            let isAfter1stEqual;

            function onClear(){
                screen2.value ="0";
                screen1.value="";
                isEqualClicked=false;
                isAfter1stEqual=false;
                isOperatorClicked=false;
                isDecimalClicked=false;
                isOperatorClickedThisEqual=false;
                sinceDecimalClicked=0;
                calcAns=0;
                screenOutput=0;
                valSc2StoreAfter1stEqual=0;
            }
            
            function onDelete(){
                valScreen2=document.getElementById("screen2").value;
                valScreen2=valScreen2.substring(0,valScreen2.length-1);
                screen2.value=valScreen2;
                if(isDecimalClicked==true){
                    sinceDecimalClicked-=1;
                }
                if(sinceDecimalClicked==0){
                    isDecimalClicked=false;
                }
                if(isEqualClicked==true){
                isEqualClicked=false;
                result=valScreen2;
                }
            }

            function onNumClick(){
                if(isEqualClicked==true){
                    onClear();
                }
                let buttonClicked = event.target.id;
                valScreen2 = document.getElementById("screen2").value;
                if (valScreen2=='0'&&buttonClicked!='.') {
                    valScreen2='';
                }
               screen2.value = valScreen2 + buttonClicked ;
               isOperatorClicked=false;
               if(isDecimalClicked==true){
                    sinceDecimalClicked+=1;
                } 
            }
            
            function onDecimal(){
                if(isDecimalClicked==false){
                    onNumClick();
                    sinceDecimalClicked=1;
                }
                else{return;}
                isDecimalClicked=true;
            }

            function round(num){
                return Math.round(num*1000)/1000;
            }
            
            function onOperator(){
                valScreen2 = document.getElementById("screen2").value;
                valScreen2 *= 1;
                operatortype=event.target.id;

                if(isEqualClicked==false&&isOperatorClickedThisEqual==false){  
                    calcAns=valScreen2;             
                    screenOutput=valScreen2;
                    screen1.value=round(screenOutput) +' '+ operatortype;
                }
                else if(isEqualClicked==true){           
                    screenOutput=calcAns;
                    screen1.value=round(screenOutput) +' '+ operatortype;
                    isEqualClicked=false;
                }
                else{
                    if(isOperatorClicked==false){
                        switch (operatortype2) {
                            case "+":   
                                calcAns=calcAns+valScreen2;                   
                                break;
                            case "-":
                                calcAns=calcAns-valScreen2;
                                break;
                            case "*":
                                calcAns=calcAns*valScreen2;
                                break;
                            case "/":
                                calcAns=calcAns/valScreen2;
                                break;
                        }
                        screenOutput=calcAns;
                        screen1.value=round(screenOutput) +' '+ operatortype;
                    }
                    else{
                        screen1.value=round(screenOutput) +' '+ operatortype;
                    }
                }
                       
                screen2.value="0";
                operatortype2=operatortype;
                isAfter1stEqual=false;
                isOperatorClicked=true;
                isOperatorClickedThisEqual=true;
                isDecimalClicked=false;
                sinceDecimalClicked=0;
            }

            function onEqual(){
                valScreen2 = document.getElementById("screen2").value;
                valScreen2 *= 1;

                screen1.value="";

                if(calcAns==0&&isOperatorClickedThisEqual==false){
                    screen2.value=valScreen2;
                    screen1.value=valScreen2;
                }
                else{
                    if(isAfter1stEqual==false){
                        valSc2StoreAfter1stEqual=valScreen2;
                        switch (operatortype) {
                        case "+":   
                            result=calcAns+valScreen2;
                            break;
                        case "-":
                            result=calcAns-valScreen2;
                            break;
                        case "*":
                            result=calcAns*valScreen2;
                            break;
                        case "/":
                            result=calcAns/valScreen2;
                            break;
                        }
                        screenOutput=result;
                        screen2.value = round(screenOutput);
                        screenOutput=calcAns;
                        screen1.value= round(screenOutput) +' '+ operatortype +' '+ round(valScreen2)+' =';
                        isAfter1stEqual=true;
                    }
                    else if(isAfter1stEqual==true){
                        switch (operatortype) {
                            case "+":   
                                result=result+valSc2StoreAfter1stEqual;
                                break;
                            case "-":
                                result=result-valSc2StoreAfter1stEqual;
                                break;
                            case "*":
                                result=result*valSc2StoreAfter1stEqual;
                                break;
                            case "/":
                                result=result/valSc2StoreAfter1stEqual;
                                break;
                        }
                        screen2.value = round(result);
                        screen1.value=round(valScreen2) +' '+ operatortype +' '+ valSc2StoreAfter1stEqual+' =';
                    }   
                }
                isEqualClicked=true;
                isOperatorClickedThisEqual=false;
                isOperatorClicked=false;
                isDecimalClicked=false;
                sinceDecimalClicked=0;
                calcAns=result;
            }
            
        </script>
    </body>
</html>